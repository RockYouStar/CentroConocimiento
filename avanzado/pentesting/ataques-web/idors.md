# IDORs

<figure><img src="../../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

Las IDOR (Insecure Direct Object References) son un tipo de vulnerabilidad de control de acceso que se produce cuando una aplicación utiliza la entrada suministrada por el usuario para acceder a un objeto (servidor), como un archivo, directorio o clave de base de datos directamente.&#x20;

Esta vulnerabilidad es la más conocida dentro del campo del Control de Acceso Inadecuado que definiremos para conocer un poco más sobre este tipo de seguridad.&#x20;

El Control de Acceso es un proceso de seguridad que controla el uso de recursos específicos dentro de unos criterios predefinidos y forma parte del modelo de seguridad AAA (Authentication, Authorization, Accounting).&#x20;

Todos los sistemas modernos utilizan determinados modelos de control de acceso para gestionar su seguridad. Los modelos de control de acceso pueden agruparse en tres clases principales:&#x20;

* control de acceso obligatorio (MAC)
* control de acceso discrecional (DAC)
* control de acceso basado en roles (RBAC)

Es decir, permiten obtener información confidencial con sólo cambiar algunos valores en el parámetro.

## Tipos de IDOR

* Blind IDOR: El tipo de IDOR en el que los resultados de la explotación no se pueden ver en la respuesta del servidor. Por ejemplo, modificar los datos privados de otros usuarios sin acceder a ellos.
* Generic IDOR: El tipo de IDOR en el que se pueden ver los resultados de la explotación en la respuesta del servidor. Por ejemplo acceder a datos confidenciales o archivos pertenecientes a otro usuario.
* IDOR w/ Reference to Objects: Se utiliza para acceder o modificar un objeto no autorizado. Por ejemplo, acceder a la información de la cuenta bancaria de otros usuarios enviando una solicitud de este tipo: `http://ejemplo.com/cuentas?id={ID de referencia}`
* IDOR w/ Reference to Files: Se utiliza para acceder a un archivo no autorizado. Por ejemplo, un servidor de chat en vivo almacena las conversaciones confidenciales en archivos con nombres como números crecientes y cualquier conversación se puede recuperar simplemente enviando solicitudes como esta: `ejemplo.com/1.log, ejemplo.com/2.log, ejemplo.com/3.log` y así sucesivamente.

## Cómo prevenir IDOR

Por lo general, este vector de ataque da lugar a errores lógicos. Los desarrolladores deben gestionar cuidadosamente la configuración y el manejo de los privilegios, así como prestar atención a las zonas de seguridad dentro de la aplicación. También deben integrar mecanismos que controlen la funcionalidad de la separación de privilegios y pensar en crear una arquitectura basada en el principio de mínimo privilegio.
