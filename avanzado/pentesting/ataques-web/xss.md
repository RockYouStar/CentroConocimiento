# XSS

<figure><img src="../../../.gitbook/assets/image (2) (2) (3).png" alt=""><figcaption></figcaption></figure>

Los ataques de Cross-Site Scripting (XSS) son un tipo de inyección, en el que se inyectan scripts maliciosos en sitios web que, de otro modo, serían inofensivos.&#x20;

Los ataques XSS se producen cuando un atacante utiliza una aplicación web para enviar código malicioso, generalmente en forma de script del lado del navegador a un usuario final diferente.&#x20;

Los fallos que permiten que estos ataques tengan éxito están bastante extendidos y se producen en cualquier lugar en el que una aplicación web utiliza la entrada de un usuario dentro de la salida que genera sin validarla o censurarla.

Un atacante puede utilizar XSS para enviar un script malicioso a un usuario desprevenido.&#x20;

El navegador del usuario final no tiene forma de saber que el script no es de confianza y lo ejecutará. Como cree que el script proviene de una fuente de confianza, el script malicioso puede acceder a cualquier cookie, tokens de sesión u otra información sensible retenida por el navegador y utilizada con ese sitio. Estos scripts pueden incluso reescribir el contenido de la página HTML.&#x20;

Podemos confirmar la mayoría de los tipos de vulnerabilidad XSS inyectando un payload que haga que tu propio navegador ejecute algún código JavaScript.&#x20;

Durante mucho tiempo ha sido una práctica común utilizar la función alert() para este propósito porque es corta, inofensiva y bastante difícil de pasar por alto cuando se ejecuta exitosamente.

## Tipos de XSS

Hay tres tipos principales de ataques XSS. Estos son:

* XSS reflejado, en el que el script malicioso proviene de la petición HTTP actual.&#x20;
* XSS almacenado, donde el script malicioso proviene de la base de datos del sitio web.&#x20;
* XSS basado en el DOM, en el que la vulnerabilidad existe en el código del lado del cliente en lugar del código del lado del servidor.

## Impacto de los ataques XSS

El impacto real de un ataque XSS generalmente depende de la naturaleza de la aplicación, su funcionalidad y datos, y el estado del usuario comprometido. Por ejemplo:

En una aplicación de tipo folleto, donde todos los usuarios son anónimos y toda la información es pública, el impacto suele ser mínimo.&#x20;

En una aplicación que contenga datos sensibles, como transacciones bancarias, correos electrónicos o registros sanitarios, el impacto será normalmente grave.&#x20;

Si el usuario comprometido tiene privilegios elevados dentro de la aplicación, entonces el impacto será generalmente crítico, permitiendo al atacante tomar el control total de la aplicación vulnerable y comprometer a todos los usuarios y sus datos.

## Cómo prevenir ataques XSS

Prevenir el cross-site scripting es trivial en algunos casos, pero puede ser mucho más difícil dependiendo de la complejidad de la aplicación y de las formas en que maneja los datos controlables por el usuario.

En general, la prevención eficaz de las vulnerabilidades XSS probablemente implique una combinación de las siguientes medidas:

1. Filtrar la entrada a la llegada. En el punto en el que se recibe la entrada del usuario, filtrar lo más estrictamente posible en función de lo que se espera o es una entrada válida.&#x20;
2. Codificar los datos en la salida. En el punto en el que los datos controlables por el usuario se emiten en las respuestas HTTP, codificar la salida para evitar que se interprete como contenido activo. Dependiendo del contexto de salida, esto podría requerir la aplicación de combinaciones de codificación HTML, URL, JavaScript y CSS.&#x20;
3. Utilice cabeceras de respuesta adecuadas. Para evitar el XSS en las respuestas HTTP que no están destinadas a contener HTML o JavaScript, puede utilizar las cabeceras Content-Type y X-Content-Type-Options para asegurarse de que los navegadores interpretan las respuestas de la forma que usted pretende.&#x20;
4. Política de seguridad de contenidos. Como última línea de defensa, puede utilizar la política de seguridad de contenidos (CSP) para reducir la gravedad de cualquier vulnerabilidad XSS que aún se produzca.
