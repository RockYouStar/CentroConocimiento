# XXE

<figure><img src="../../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

Las inyecciones de entidad externa XML (XXE) son un tipo de vulnerabilidad que se han hecho muy populares en los últimos años.

Básicamente, se trata de un tipo de ataque contra una aplicación que analiza entradas XML.&#x20;

A grandes rasgos, las DTD (Document Type Definition) se utilizan para definir la estructura de un documento XML y dentro de ellas se pueden declarar entidades XML.

Existe un tipo especial de entidades XML llamadas "entidades externas", que se utilizan para acceder a contenidos locales o remotos con una URL.

Por ejemplo, este DTD declara una entidad externa llamada "file" que apunta a: `file:///nominas.txt` , en el sistema de archivos local. El analizador XML sustituirá cualquier referencia en el documento por el contenido de `file:///nominas.txt`

```xml
<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE example [
   <! ENTITY file SYSTEM "file: ///nominas.txt">
]>
<example> & file; </example>
```

Si los usuarios pueden declarar entidades XML de forma arbitraria en sus `payloads`, pueden declarar una entidad externa a cualquier ubicación de su máquina.

Por ejemplo, este archivo XML contiene una entidad externa que apunta a `file:////etc/passwd` en su servidor.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE example [
  <!ENTITY file SYSTEM "file:////etc/passwd" >
]>
<example>&file;</example>
```

Cuando el documento XML es visualizado/parseado por la web, se mostrará el archivo /etc/passwd del sistema.
